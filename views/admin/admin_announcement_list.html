{% include "include/header.html" %}

<link rel="stylesheet" href="/assets/css/admin.css">

<main class="admin-container">
  <h1 class="admin-title">공지 관리</h1>

  <div class="admin-actions">
<a class="btn btn-primary" href="/admin/announcements/form">새 공지</a>
    <a class="btn btn-primary" href="/announcements">사용자 목록 보기</a>
  </div>

  <table class="admin-table">
    <thead>
      <tr>
        <th class="ta-left">제목</th>
        <th class="ta-center w-90">상태</th>
        <th class="ta-center w-80">고정</th>
        <th class="ta-center w-160">게시시각</th>
        <th class="ta-center w-80">조회</th>
        <th class="ta-center w-260">관리</th>
      </tr>
    </thead>
    <tbody>
      {% for n in rows %}
      <tr>
        <td>
          <a class="link" href="/announcements/{{ n.notice_id }}" target="_blank">{{ n.title }}</a>
          <div class="meta">{{ n.category }}</div>
        </td>
        <td class="ta-center">{{ n.status }}</td>
        <td class="ta-center">
          {% if n.is_pinned %}Y{% else %}N{% endif %}
        </td>
        <td class="ta-center">{{ n.published_at | date('YYYY-MM-DD HH:mm') }}</td>
        <td class="ta-center">{{ n.view_count }}</td>
        <td class="ta-center">
          <a class="btn btn-ghost" href="/admin/announcements/{{ n.notice_id }}/edit">수정</a>

          <form class="inline" action="/admin/announcements/{{ n.notice_id }}/delete" method="post">
            <button type="submit" class="btn btn-danger">삭제</button>
          </form>

          {% if n.status == 'PUBLISHED' %}
          <form class="inline" action="/admin/announcements/{{ n.notice_id }}/draft" method="post">
            <button type="submit" class="btn btn-ghost">드래프트</button>
          </form>
          {% else %}
          <form class="inline" action="/admin/announcements/{{ n.notice_id }}/publish" method="post">
            <button type="submit" class="btn btn-primary">발행</button>
          </form>
          {% endif %}
        </td>
      </tr>
      {% else %}
      <tr>
        <td colspan="6" class="empty">등록된 공지가 없습니다.</td>
      </tr>
      {% endfor %}
    </tbody>

  </table>
</main>