{%include "include/header.html"%}
<main class="announcement_list_container">
    <div class="page-head">
        <p class="page-title">공지사항</p>
        <form class="notice-search" method="get" action="/announcements">
            <input type="text" name="keyword" placeholder="검색어를 입력하세요" value="{{ keyword or '' }}" />
            <button type="submit"><i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i></button>
        </form>

    </div>
    <div class="line1"></div>
    <!-- 목록 영역: 실제 서비스에선 서버/JS로 동적 채움 -->
    <ul class="notice-list" id="noticeList">
        {% for n in notices %}
        <li class="notice-item">
            <a href="/support/announcements/{{ n.notice_id }}">
                <div class="row">
                    <div>
                        <div class="title-line">
                            {% if n.is_pinned %}<span class="badge">공지</span>{% endif %}
                            <span class="title">{{ n.title }}</span>
                        </div>
                        <div class="meta">
                            <span class="category">{{ n.category }}</span>
                            <time datetime="{{ n.published_at | date('YYYY-MM-DDTHH:mm') }}">
                                {{ n.published_at | date('YYYY-MM-DD HH:mm') }}
                            </time>
                        </div>
                    </div>
                    <div class="right"><span class="views">조회 {{ n.view_count }}</span></div>
                </div>
            </a>
        </li>
        {% else %}
        <li class="notice-item">
            <div class="row">
                <div>
                    {% if keyword %}
                    검색 결과가 없습니다. (검색어: "{{ keyword }}")
                    {% else %}
                    표시할 공지가 없습니다.
                    {% endif %}
                </div>
            </div>
        </li>
        {% endfor %}
    </ul>

    <!-- 페이지네이션 -->
    {% if totalPages > 1 %}
    <nav class="pagination" aria-label="공지 페이지 이동">
        {% if currentPage > 1 %}
        <a href="?page={{ currentPage - 1 }}{% if keyword %}&keyword={{ keyword }}{% endif %}" class="page-btn">이전</a>
        {% else %}
        <span class="page-btn disabled">이전</span>
        {% endif %}
        
        <span class="page-info">{{ currentPage }} / {{ totalPages }}</span>
        
        {% if currentPage < totalPages %}
        <a href="?page={{ currentPage + 1 }}{% if keyword %}&keyword={{ keyword }}{% endif %}" class="page-btn">다음</a>
        {% else %}
        <span class="page-btn disabled">다음</span>
        {% endif %}
    </nav>
    {% endif %}
</main>

<script>
    // 빈 목록 처리는 서버에서 처리하므로 불필요
</script>



{%include "include/footer.html"%}